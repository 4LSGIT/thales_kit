

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Traffic Light &mdash; SunFounder Thales Kit for Raspberry Pi Pico 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Two Kinds of Transistors" href="Hello, Transistor!.html" />
    <link rel="prev" title="Reaction Game" href="Reaction Game.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SunFounder Thales Kit for Raspberry Pi Pico
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction to Raspberry Pi Pico.html">Introduction to Raspberry Pi Pico</a></li>
<li class="toctree-l1"><a class="reference internal" href="What is MicroPython.html">What is MicroPython?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Thonny Python IDE.html">Thonny Python IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="Your First MicroPython Program.html">Your First MicroPython Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="MicroPython Basic Syntax.html">MicroPython Basic Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="Components Introduction.html">Components Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Lesson.html">Lessons</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="First program! Hello, LED!.html">Hello, LED!</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hello, Breadboard!.html">Hello, Breadboard!</a></li>
<li class="toctree-l2"><a class="reference internal" href="reading_button_values.html">Reading Button Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reaction Game.html">Reaction Game</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Traffic Light</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wiring">Wiring</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code">Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">How it works?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Hello, Transistor!.html">Two Kinds of Transistors</a></li>
<li class="toctree-l2"><a class="reference internal" href="Intruder Alarm.html">Intruder Alarm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fading LED.html">Fading LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="Colorful Light.html">Colorful Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="Custom tone.html">Custom Tone</a></li>
<li class="toctree-l2"><a class="reference internal" href="Swinging Servo.html">Swinging Servo</a></li>
<li class="toctree-l2"><a class="reference internal" href="Turn the knob.html">Turn the Knob</a></li>
<li class="toctree-l2"><a class="reference internal" href="Thermometer.html">Thermometer</a></li>
<li class="toctree-l2"><a class="reference internal" href="Light Theremin.html">Light Theremin</a></li>
<li class="toctree-l2"><a class="reference internal" href="Microchip - 74HC595.html">Microchip - 74HC595</a></li>
<li class="toctree-l2"><a class="reference internal" href="LED Segment Display.html">LED Segment Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="Liquid Crystal Display.html">Liquid Crystal Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="RGB LED Strip.html">RGB LED Strip</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SunFounder Thales Kit for Raspberry Pi Pico</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="Lesson.html">Lessons</a> &raquo;</li>
        
      <li>Traffic Light</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Traffic light.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="traffic-light">
<h1>Traffic Light<a class="headerlink" href="#traffic-light" title="Permalink to this headline">¶</a></h1>
<p>In addition to home electronic devices, many microcontrollers can also be found in the social environment, including traffic lights.
Traffic lights are used to direct traffic operation and are generally composed of red, green, and yellow lights.
Building a huge traffic management system is a fairly advanced project, but using Pico to drive a miniature traffic light is a project we can try.</p>
<p>Let’s make a mini pedestrian crossing system with a few LEDs and a button!</p>
<div class="section" id="wiring">
<h2>Wiring<a class="headerlink" href="#wiring" title="Permalink to this headline">¶</a></h2>
<img alt="_images/wiring_traffic_light.png" src="_images/wiring_traffic_light.png" />
<ol class="arabic simple">
<li><p>Connect 3V3 and GND of Pico to the breadboard power bus.</p></li>
<li><p>Insert the red, yellow, and green LEDs on the breadboard.</p></li>
<li><p>GP13, GP14, GP15 are each connected to a 220Ω resistor and then connected to the anode of the LED.</p></li>
<li><p>Connect the cathodes of the LEDs to the negative power bus of the breadboard.</p></li>
<li><p>Insert the Button, connect one side of it to the GP16 pin, and connect a 10kΩ resistor in series to the negative power bus, and the other side to the positive power bus.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The color ring of 220 ohm resistor is red, red, black, black and brown.
The color ring of the 10k ohm resistor is brown, black, black, red and brown.</p>
</div>
</div>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<p>When the program is started, the traffic light will switch in the order of red for 5 seconds, yellow for 2 seconds, green for 5 seconds, and yellow for 2 seconds.
If we (pedestrians) press the button, the next red light will be extended to 15 seconds, which will give us more time to cross the road.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">import</span> <span class="nn">utime</span>
<span class="kn">import</span> <span class="nn">_thread</span>

<span class="n">led_red</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">led_yellow</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">led_green</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">button</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>

<span class="k">global</span> <span class="n">button_status</span>
<span class="n">button_status</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">button_thread</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">button_status</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">button</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">button_status</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">_thread</span><span class="o">.</span><span class="n">start_new_thread</span><span class="p">(</span><span class="n">button_thread</span><span class="p">,</span> <span class="p">())</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">button_status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">button_status</span>
    <span class="n">button_status</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_green</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">led_green</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="how-it-works">
<h2>How it works?<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>In the previous chapters, we have successfully made the LED blink. In other words, it is very simple for us to write a code that makes the traffic light cycle color. What we need to do is to add a judgment on the state of the button.
But if we directly write the statement that reads the button value in the main program, we will find that it doesn’t fit anywhere. Even if we write it in, we can hardly read the value.
This is because the program is stuck when executing <a href="#id1"><span class="problematic" id="id2">``</span></a>utime.sleep()’’, and the statement to read the button value is not executed at this time.</p>
<p>Of course, we can read the key value through the IRQs of the previous lesson. But this time we take another approach-multithreading.</p>
<p>Multi-threading can be simply understood as dividing a thing into multiple parts, which are executed by different people (or processors).
Just like when the chef is frying the steak, the assistant chef will make the sauce so that the newly prepared sauce can be poured on the properly prepared steak to make the best cooking.</p>
<p>Look at these lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">import</span> <span class="nn">utime</span>
<span class="hll"><span class="kn">import</span> <span class="nn">_thread</span>
</span>
<span class="n">led_red</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">led_yellow</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">led_green</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">button</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>

<span class="k">global</span> <span class="n">button_status</span>
<span class="n">button_status</span> <span class="o">=</span> <span class="mi">0</span>

<span class="hll"><span class="k">def</span> <span class="nf">button_thread</span><span class="p">():</span>
</span>    <span class="k">global</span> <span class="n">button_status</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">button</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">button_status</span> <span class="o">=</span> <span class="mi">1</span>

<span class="hll"><span class="n">_thread</span><span class="o">.</span><span class="n">start_new_thread</span><span class="p">(</span><span class="n">button_thread</span><span class="p">,</span> <span class="p">())</span>
</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">button_status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">button_status</span>
    <span class="n">button_status</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_green</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">led_green</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">_thread</span></code> library is imported first. This module implements multithreading support.
Then define a thread <code class="docutils literal notranslate"><span class="pre">button_thread()</span></code>, which is independent of the main thread. It is used here to read the state of the button.
Finally use <code class="docutils literal notranslate"><span class="pre">_thread.start_new_thread(button_thread,</span> <span class="pre">())</span></code> to start the thread.</p>
<p>Let us use the following code to better understand multithreading:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">import</span> <span class="nn">utime</span>
<span class="kn">import</span> <span class="nn">_thread</span>

<span class="n">led_red</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">led_yellow</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">button</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">led_yellow_thread</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">led_yellow</span><span class="o">.</span><span class="n">toggle</span><span class="p">()</span>
        <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">_thread</span><span class="o">.</span><span class="n">start_new_thread</span><span class="p">(</span><span class="n">led_yellow_thread</span><span class="p">,</span> <span class="p">())</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">button_status</span> <span class="o">=</span> <span class="n">button</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">button_status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">button_status</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>In the main thread, we can use buttons to control the red LED on and off. In the new thread, the yellow LED will change every 2 seconds. The two threads work independently of each other.</p>
<p>Let’s go back to the traffic signal program. We let the main thread change the light and let the new thread read the button value.
However, the threads are independent of each other, and we need a way for the new thread to pass information to the main thread, which requires the use of global variables.</p>
<p>The variables we have used before are local variables and only work in one part of the program (variables declared in the main function cannot be used in sub-functions, and variables declared in the main thread cannot be used in the new thread).
The global variable can be used anywhere, we change it in one thread, and the other can get its updated value.</p>
<p>Global variables are in these places:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">import</span> <span class="nn">utime</span>
<span class="kn">import</span> <span class="nn">_thread</span>

<span class="n">led_red</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">led_yellow</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">led_green</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">button</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>

<span class="hll"><span class="k">global</span> <span class="n">button_status</span>
</span><span class="hll"><span class="n">button_status</span> <span class="o">=</span> <span class="mi">0</span>
</span>
<span class="k">def</span> <span class="nf">button_thread</span><span class="p">():</span>
<span class="hll">    <span class="k">global</span> <span class="n">button_status</span>
</span>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">button</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="hll">            <span class="n">button_status</span> <span class="o">=</span> <span class="mi">1</span>
</span>
<span class="n">_thread</span><span class="o">.</span><span class="n">start_new_thread</span><span class="p">(</span><span class="n">button_thread</span><span class="p">,</span> <span class="p">())</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="hll">    <span class="k">if</span> <span class="n">button_status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span>        <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="hll">    <span class="k">global</span> <span class="n">button_status</span>
</span><span class="hll">    <span class="n">button_status</span> <span class="o">=</span> <span class="mi">0</span>
</span>
    <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">led_red</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_green</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">led_green</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">utime</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">led_yellow</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>When the program is just running, <code class="docutils literal notranslate"><span class="pre">button_status</span></code> is assigned a value of 0, which means that the button has not been pressed.</p></li>
<li><p>In the new thread, when the program detects that the button is pressed, <code class="docutils literal notranslate"><span class="pre">button_status</span></code> is assigned the value 1.</p></li>
<li><p>In the loop of the main thread, <code class="docutils literal notranslate"><span class="pre">button_status</span></code> will be checked once before each traffic light change cycle. If the status is 1, it will execute an extra red light time, then switch to 0, and wait for the next button press.</p></li>
</ul>
<p>The function of <code class="docutils literal notranslate"><span class="pre">global</span> <span class="pre">button_status</span></code> is to tell the program that we are about to modify the value of this global variable. If we want to read the value of a variable, this line is not needed; if we want to modify the value of a variable, we must add it.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Hello, Transistor!.html" class="btn btn-neutral float-right" title="Two Kinds of Transistors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Reaction Game.html" class="btn btn-neutral float-left" title="Reaction Game" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, SunFounder.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>