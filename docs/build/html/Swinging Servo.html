

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Swinging Servo &mdash; SunFounder Thales Kit for Raspberry Pi Pico 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Turn the Knob" href="Turn the knob.html" />
    <link rel="prev" title="Custom Tone" href="Custom tone.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SunFounder Thales Kit for Raspberry Pi Pico
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction to Raspberry Pi Pico.html">Introduction to Raspberry Pi Pico</a></li>
<li class="toctree-l1"><a class="reference internal" href="What is MicroPython.html">What is MicroPython?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Thonny Python IDE.html">Thonny Python IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="Your First MicroPython Program.html">Your First MicroPython Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="MicroPython Basic Syntax.html">MicroPython Basic Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="Components Introduction.html">Components Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Lesson.html">Lessons</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="First program! Hello, LED!.html">Hello, LED!</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hello, Breadboard!.html">Hello, Breadboard!</a></li>
<li class="toctree-l2"><a class="reference internal" href="reading_button_values.html">Reading Button Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reaction Game.html">Reaction Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="Traffic light.html">Traffic Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hello, Transistor!.html">Two Kinds of Transistors</a></li>
<li class="toctree-l2"><a class="reference internal" href="Intruder Alarm.html">Intruder Alarm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fading LED.html">Fading LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="Colorful Light.html">Colorful Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="Custom tone.html">Custom Tone</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Swinging Servo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wiring">Wiring</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code">Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">How it works?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Turn the knob.html">Turn the Knob</a></li>
<li class="toctree-l2"><a class="reference internal" href="Thermometer.html">Thermometer</a></li>
<li class="toctree-l2"><a class="reference internal" href="Light Theremin.html">Light Theremin</a></li>
<li class="toctree-l2"><a class="reference internal" href="Microchip - 74HC595.html">Microchip - 74HC595</a></li>
<li class="toctree-l2"><a class="reference internal" href="LED Segment Display.html">LED Segment Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="Liquid Crystal Display.html">Liquid Crystal Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="RGB LED Strip.html">RGB LED Strip</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SunFounder Thales Kit for Raspberry Pi Pico</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="Lesson.html">Lessons</a> &raquo;</li>
        
      <li>Swinging Servo</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Swinging Servo.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="swinging-servo">
<h1>Swinging Servo<a class="headerlink" href="#swinging-servo" title="Permalink to this headline">¶</a></h1>
<p>In this kit, in addition to LED and passive buzzer, there is also a device controlled by PWM signal, Servo.</p>
<p>Servo is a position (angle) servo device, which is suitable for those control systems that require constant angle changes and can be maintained. It has been widely used in high-end remote control toys, such as airplanes, submarine models, and remote control robots.</p>
<p>Now, try to make the servo sway!</p>
<div class="section" id="wiring">
<h2>Wiring<a class="headerlink" href="#wiring" title="Permalink to this headline">¶</a></h2>
<img alt="_images/wiring_swing_servo.png" src="_images/wiring_swing_servo.png" />
<ol class="arabic simple">
<li><p>Press the Servo Arm into the Servo output shaft. If necessary, fix it with screws.</p></li>
<li><p>Connect <strong>VBUS</strong> (not 3V3) and GND of Pico to the power bus of the breadboard.</p></li>
<li><p>Connect the red lead of the servo to the positive power bus with a jumper.</p></li>
<li><p>Connect the yellow lead of the servo to the GP15 pin with a jumper wire.</p></li>
<li><p>Connect the black lead of the servo to the negative power bus with a jumper wire.</p></li>
</ol>
</div>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>import machine
import utime

servo = machine.PWM(machine.Pin(15))
servo.freq(50)

def interval_mapping(x, in_min, in_max, out_min, out_max):
    return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min

def servo_write(pin,angle):
    pulse_width=interval_mapping(angle, 0, 180, 0.5,2.5)
    duty=int(interval_mapping(pulse_width, 0, 20, 0,65535))
    pin.duty_u16(duty)

while True:
    for angle in range(180):
        servo_write(servo,angle)
        utime.sleep_ms(20)
    for angle in range(180,-1,-1):
        servo_write(servo,angle)
        utime.sleep_ms(20)


        When the program is running, we can see the Servo Arm swinging back and forth from 0° to 180°. The program will always run because of the ``while True`` loop, we need to press the Stop key to end the program.
</pre></div>
</div>
</div>
<div class="section" id="how-it-works">
<h2>How it works?<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>We defined the <a href="#id1"><span class="problematic" id="id2">``</span></a>servo_write()’’ function to make the servo run.</p>
<p>This function has two parameters:</p>
<ul class="simple">
<li><p>pin, the GPIO pin that controls the servo.</p></li>
<li><p>Angle, the angle of the shaft output.</p></li>
</ul>
<p>In this function, <code class="docutils literal notranslate"><span class="pre">interval_mapping()</span></code> is called to map the angle range 0 ~ 180 to the pulse width range 0.5 ~ 2.5ms.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pulse_width</span><span class="o">=</span><span class="n">interval_mapping</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Why is it 0.5~2.5? This is determined by the working mode of the steering gear.</p>
<img alt="_images/servo1.png" src="_images/servo1.png" />
<p>It works like this: The microcontroller sends out PWM signals to the servo, and then the embedded board in the servo receives the signals through the signal pin and controls the motor inside to turn.
As a result, the motor drives the gear system and then motivates the shaft after deceleration.
The shaft and potentiometer of the servo are connected together.
When the shaft rotates, it drives the potentiometer, so the potentiometer outputs a voltage signal to the embedded board.
Then the board determines the direction and speed of rotation based on the current position, so it can stop exactly at the right position as defined and hold there.</p>
<img alt="_images/servo3.png" src="_images/servo3.png" />
<p>The angle is determined by the duration of a pulse that is applied to the control wire. The servo expects to see a pulse every 20 ms (That’s why we set the pwm frequency to 50hz).</p>
<p>The length of the pulse will determine how far the motor turns.
For example, a 1.5ms pulse will make the motor turn to the 90 degree position (neutral position).
When a pulse is sent to a servo that is less than 1.5 ms, the servo rotates to a position and holds its output shaft some degrees counterclockwise from the neutral point.
When the pulse is wider than 1.5 ms the opposite occurs. The minimal width and the maximum width of pulse that will command the servo to turn to a valid position are functions of each servo.
Generally the minimum pulse will be about 0.5 ms wide and the maximum pulse will be 2.5 ms wide.</p>
<p>Next, convert the pulse width from period to duty. Since duty_u16() cannot have decimals when used (the value cannot be a float type), we used <code class="docutils literal notranslate"><span class="pre">int()</span></code> to force the duty to be converted to an int type.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">duty</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">interval_mapping</span><span class="p">(</span><span class="n">pulse_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">65535</span><span class="p">))</span>
</pre></div>
</div>
<p>Finally, write the duty value into duty_u16().</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Turn the knob.html" class="btn btn-neutral float-right" title="Turn the Knob" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Custom tone.html" class="btn btn-neutral float-left" title="Custom Tone" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, SunFounder.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>